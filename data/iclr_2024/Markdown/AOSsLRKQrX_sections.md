## Abstract

We focus on the task of visual dynamics prediction. Recent work has shown that object-centric representations can greatly help improve the accuracy of learning dynamics. Building on top of this work, we ask the question: would it help to learn disentangled object representations, possibly separating the attributes which contribute to the motion dynamics vs which donâ€™t? Though there is some prior work which aims to achieve this, we argue in this paper either it is limiting in their setting, or does not use the learned representation explicitly for predicting visual In response, we propose DisFormer, an dynamics, making them sub-optimal. approach for learning disentangled object representation and use them for predict- ing visual dynamics. Our architecture extends the notion of slots Locatello et al. (2020) to taking attention over individual object representations: each slot learns the representation for a block by attending over different parts of an object, and each block is expressed as a linear combination over a small set of learned con- cepts. We perform an iterative refinement over these slots to extract a disentangled representation, which is then fed to a transformer architecture to predict the next set of latent object representations. Since our approach is unsupervised, we need to align the output object masks with those extracted from the ground truth image, and we design a novel permutation module to achieve this alignment by learning a canonical ordering. We perform a series of experiments demonstrating that our learned representations help predict future dynamics in the standard setting, where we test on the same environment as training, and in the setting of transfer, where certain object combinations are never seen before. Our method outperforms exist- ing baselines in terms of pixel prediction and deciphering the dynamics, especially in the zero-shot transfer setting where existing approaches fail miserably. Further analysis reveals that our learned representations indeed help with significantly bet- ter disentanglement of objects compared to existing techniques. 1

## Introduction

Predicting visual dynamics is an important problem that finds applications in computer vision, model-based reinforcement learning, and visual question answering. Some of the classic work does this by having dense representation for the image and then passing through a CNN-based or now transformer-based architecture. More recent approaches have argued for the use of object-centric representations, presumably because they can better capture the natural semantics of how objects are represented in a scene and their interactions, for the task of dynamics prediction. This line of work can further be divided into two sets of categories: ones that work with dense object embeddings learned from the data Wu et al. (2023) and those that try to decompose each object representation in terms of its attributes Singh et al. (2022b). While in the former category, the latest models exploit the power of transformers to get the future dynamics, works in the second category have exploited autoencoder-based models, or GNN-based models, to learn disentangled representation for down- stream learning of dynamics. Interestingly, some of the SOTA models Wu et al. (2023) do not use disentangled representation, leaving a possibility of further improvement in performance on this task while having a more interpretable representation. 1 Under review as a conference paper at ICLR 2024 Even among the techniques that make use of a disentangled object representation, they are limited by their assumptions: (1) They either work with objects of the same size Kossen et al. (2019) (2) Or divide the attributes only into two sets: those relevant for dynamics, vs which are not Nakano et al. (2023). Both these assumptions are pretty restrictive. The closest to our work is Lin et al. (2020a), which can learn disentangled representations, but it does it with a fixed number of concepts indepen- dent of the problem space. As observed in our experiments, this severely affects their performance, especially in the setting of transfer, for instance, where certain attribute combinations are never seen before. Motivated by these research gaps, we push the boundaries on two fronts: (1) Work with a more flexible disentangled representation, which can choose the number of concepts depending on the specific problem; (2) Combine the learned representation with the power of transformer-based architectures, which have been shown to do very well on future prediction tasks. We refer to our system as DisFormer. Our work, in the form of DisFormer, presents several novel contributions. Starting with masks extracted from an object extractor, our key idea is to represent each object as a set of blocks, where each block is expressed as a linear combination of underlying (learned) concepts. Intuitively, each block (or a set of blocks) can be thought of as potentially representing an underlying natural attribute of an object (e.g., size, colour etc.). While such an idea has been explored in earlier work Singh et al. (2022b), it is limited to the case of static images, whereas our goal is to tie the learned representation with dynamics prediction, resulting in some significant technical differences. In order to learn the individual block representation, we use the notion of a slot Locatello et al. (2020). Whereas in the original slot attention paper, each slot binds to a particular object, and its representation is obtained by iteratively refining a vector attending over the entire image, in our case, each slot represents a block, which attends over an object, and its iterative refinement results in the final representation of the block. Disentanglement is guided by forcing each block to be a linear combination of a small number of learned concepts. The final object representation is the concatenation of the blocks. For dynamics prediction, we pass the latent representation for the entire set of extracted objects in the image, along with one for the background, to a transformer. A position embedding for each block distinguishes it from others. Since object masks can be discovered in any order, we need to impose a canonical ordering over them so that loss can be taken for the final image. This is done via a novel permutation module, which learns to map object representations to a canonical ordering starting from any given ordering over them. Finally, instead of passing the object representation as a single vector during decoding, we directly map the discovered blocks to individual channels, further reinforcing the discovery of a disentangled representation. For the object extractor, we make use of a Mask-RCNN trained on labels provided by an unsupervised extractor Gupta et al. (2021), for 2D scenes, and slot attention Locatello et al. (2020), for the case of 3D scenes. For our decoder, we use a standard architecture Watters et al. (2019) along with mapping of attribute representation to channels as described above. Extensive experimentation on both 2D and 3D datasets shows that our approach outperforms ex- isting SOTA baselines both in terms of pixel error and dynamics, for up to 15 steps of prediction. Further, we create transfer datasets for 2D environments and we observe that our model performs much better in zero-shot settings than the baselines that fail miserably1. The rest of the paper is organized as follows: in section 2, we will discuss the
